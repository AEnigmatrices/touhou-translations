import{q as T,j as n,I as _,r as s,C as F,B as w,T as U}from"./chunk-BpirLx0P.js";import{P as K}from"./chunk-CD-fnnhK.js";import{T as Q}from"./chunk-DScV9tmX.js";import{T as N}from"./chunk-BiW3RtM-.js";import{B as Z}from"./chunk-CvXUea7K.js";const J=T(n.jsx("path",{d:"M22 16V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2m-11-4 2.03 2.71L16 11l4 5H8zM2 6v14c0 1.1.9 2 2 2h14v-2H4V6z"})),X=T(n.jsx("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"})),Y=T(n.jsx("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"})),tt={none:"none",asc:"ascending",desc:"descending"},A={asc:X,desc:Y,none:J},et=r=>tt[r],rt=({sortOrder:r,onToggleSortOrder:d})=>{const p=A[r]??A.none;return n.jsx(Q,{title:"Sort by Artwork Count",arrow:!0,children:n.jsx(_,{"aria-label":"Sort by Artwork Count","aria-pressed":r!=="none","aria-sort":et(r),onClick:d,color:r==="none"?"default":"primary",size:"medium",children:n.jsx(p,{})})})},h={container:{px:{xs:0},py:4},box:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",gap:3,mb:5,px:2},typography:{flexBasis:"100%",textAlign:"center",color:"text.primary",fontWeight:600,mb:2,letterSpacing:"0.05em"},textField:{maxWidth:300,flexGrow:1,minWidth:220},listGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",listStyle:"none",padding:0,margin:0,"@media (max-width:1024px)":{gridTemplateColumns:"repeat(3, 1fr)"},"@media (max-width:768px)":{gridTemplateColumns:"repeat(2, 1fr)"},"@media (max-width:480px)":{gridTemplateColumns:"1fr"}}},a="character",y="artist",I="/touhou-translations/",j=25,it=({mode:r,characters:d,artists:p})=>{const v=r===a?"Character List":"Artist List",E=r===a?"Search Characters":"Search Artists";if(r===a&&!d||r===y&&!p)throw new Error(`${r} data prop is required`);const C=s.useMemo(()=>r===a?d:p,[r,d,p]),[S,B]=s.useState(""),[x,R]=s.useState(""),[i,M]=s.useState(!1),[c,V]=s.useState([]),[l,z]=s.useState(r===y?"desc":"none"),[k,$]=s.useState(j),b=s.useRef(null),L=s.useMemo(()=>x?C.filter(({id:t,name:e})=>[t,e].some(o=>o.toLowerCase().includes(x.toLowerCase()))):C,[C,x]),m=s.useMemo(()=>{const t=(e,o)=>{if(l==="none")return r===y?e.id.localeCompare(o.id):0;const u=l==="asc"?e.artworkCount-o.artworkCount:o.artworkCount-e.artworkCount;if(u!==0)return u;const[g,f]=r===a?[e.artistCount,o.artistCount]:[e.characterCount,o.characterCount];return l==="asc"?g-f:f-g};return[...L].sort(t)},[L,l,r]),D=()=>{z(t=>t==="none"?"desc":t==="desc"?"asc":"none")},P=()=>{i&&c.length===0?M(!1):M(!i)},W=()=>{if(i&&c.length>0){const e=`${I}gallery?${r===a?"characters":"artists"}=${c.join(",")}`;window.location.href=e}else P()},q=t=>{V(e=>e.includes(t)?e.filter(o=>o!==t):[...e,t])},G=()=>m.slice(0,k).map(t=>{const e=t.id,o=t.name,u=`${t.artworkCount} artwork${t.artworkCount!==1?"s":""}`,g=r===a?`${t.artistCount} artist${t.artistCount!==1?"s":""}`:`${t.characterCount} character${t.characterCount!==1?"s":""}`,f=`${I}${t.portrait}`,H=c.includes(e),O=`${I}gallery?${r===a?"characters":"artists"}=${c.join(",")||e}`;return n.jsx(K,{name:o,imageUrl:f,description1:u,description2:g,link:i?void 0:O,isSelectMode:i,isSelected:H,onToggleSelect:()=>q(e)},e)});return s.useEffect(()=>{const t=setTimeout(()=>R(S),300);return()=>clearTimeout(t)},[S]),s.useEffect(()=>{const t=new IntersectionObserver(o=>{o[0].isIntersecting&&$(u=>Math.min(u+j,m.length))},{rootMargin:"100px"}),e=b.current;return e&&t.observe(e),()=>{e&&t.unobserve(e)}},[m]),s.useEffect(()=>{$(j)},[x,l]),n.jsxs(F,{maxWidth:"xl",sx:h.container,children:[n.jsxs(w,{sx:h.box,children:[n.jsx(U,{variant:"h4",component:"h2",sx:h.typography,children:v}),n.jsx(N,{label:"Search by ID or Name",variant:"outlined",value:S,sx:h.textField,onChange:t=>B(t.target.value),slotProps:{input:{"aria-label":E}}}),n.jsx(Z,{variant:"contained",onClick:W,children:i?c.length>0?`View ${c.length} Selected`:"Exit Select Mode":"Select Multiple"}),n.jsx(rt,{sortOrder:l,onToggleSortOrder:D})]}),n.jsx(w,{component:"ul",sx:h.listGrid,children:G()}),k<m.length&&n.jsx(w,{ref:b,sx:{height:"1px"}})]})};export{it as L};
