import{q as m,j as r,I as E,r as s,C as N,B as h,T as $}from"./chunk-B02Z8Qk5.js";import{P as U}from"./chunk-BNntPdp1.js";import{T as K}from"./chunk-DTuD8vVP.js";import{T as Q}from"./chunk-CzV4nwPq.js";import{B as Z}from"./chunk-Z4qJW9Sn.js";const J=m(r.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"})),X=m(r.jsx("path",{d:"M19 5v14H5V5zm0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2"})),Y=m(r.jsx("path",{d:"M22 16V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2m-11-4 2.03 2.71L16 11l4 5H8zM2 6v14c0 1.1.9 2 2 2h14v-2H4V6z"})),tt=m(r.jsx("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"})),et=m(r.jsx("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"})),rt={none:"none",asc:"ascending",desc:"descending"},A={asc:tt,desc:et,none:Y},nt=n=>rt[n],ot=({sortOrder:n,onToggleSortOrder:d})=>{const x=A[n]??A.none;return r.jsx(K,{title:"Sort by Artwork Count",arrow:!0,children:r.jsx(E,{"aria-label":"Sort by Artwork Count","aria-pressed":n!=="none","aria-sort":nt(n),onClick:d,color:n==="none"?"default":"primary",size:"medium",children:r.jsx(x,{})})})},p={container:{px:{xs:0},py:4},box:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",gap:3,mb:5,px:2},typography:{flexBasis:"100%",textAlign:"center",color:"text.primary",fontWeight:600,mb:2,letterSpacing:"0.05em"},textField:{maxWidth:300,flexGrow:1,minWidth:220},listGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",listStyle:"none",padding:0,margin:0,"@media (max-width:1024px)":{gridTemplateColumns:"repeat(3, 1fr)"},"@media (max-width:768px)":{gridTemplateColumns:"repeat(2, 1fr)"},"@media (max-width:480px)":{gridTemplateColumns:"1fr"}}},c="character",I="artist",j="/touhou-translations/",T=25,ut=({mode:n,characters:d,artists:x})=>{const B=n===c?"Character List":"Artist List",V=n===c?"Search Characters":"Search Artists";if(n===c&&!d||n===I&&!x)throw new Error(`${n} data prop is required`);const y=s.useMemo(()=>n===c?d:x,[n,d,x]),[w,z]=s.useState(""),[g,H]=s.useState(""),[a,k]=s.useState(!1),[i,O]=s.useState([]),[l,R]=s.useState(n===I?"desc":"none"),[M,v]=s.useState(T),b=s.useRef(null),L=s.useMemo(()=>g?y.filter(({id:t,name:e})=>[t,e].some(o=>o.toLowerCase().includes(g.toLowerCase()))):y,[y,g]),f=s.useMemo(()=>{const t=(e,o)=>{if(l==="none")return n===I?e.id.localeCompare(o.id):0;const u=l==="asc"?e.artworkCount-o.artworkCount:o.artworkCount-e.artworkCount;if(u!==0)return u;const[C,S]=n===c?[e.artistCount,o.artistCount]:[e.characterCount,o.characterCount];return l==="asc"?C-S:S-C};return[...L].sort(t)},[L,l,n]),D=()=>{R(t=>t==="none"?"desc":t==="desc"?"asc":"none")},F=()=>{a&&i.length===0?k(!1):k(!a)},P=()=>{if(i.length===0)return;const e=`${j}gallery?${n===c?"characters":"artists"}=${i.join(",")}`;window.location.href=e},W=t=>{O(e=>e.includes(t)?e.filter(o=>o!==t):[...e,t])},q=()=>f.slice(0,M).map(t=>{const e=t.id,o=t.name,u=`${t.artworkCount} artwork${t.artworkCount!==1?"s":""}`,C=n===c?`${t.artistCount} artist${t.artistCount!==1?"s":""}`:`${t.characterCount} character${t.characterCount!==1?"s":""}`,S=`${j}${t.portrait}`,G=i.includes(e),_=`${j}gallery?${n===c?"characters":"artist"}=${i.join(",")||e}`;return r.jsx(U,{name:o,imageUrl:S,description1:u,description2:C,link:a?void 0:_,isSelectMode:a,isSelected:G,onToggleSelect:()=>W(e)},e)});return s.useEffect(()=>{const t=setTimeout(()=>H(w),300);return()=>clearTimeout(t)},[w]),s.useEffect(()=>{const t=new IntersectionObserver(o=>{o[0].isIntersecting&&v(u=>Math.min(u+T,f.length))},{rootMargin:"100px"}),e=b.current;return e&&t.observe(e),()=>{e&&t.unobserve(e)}},[f]),s.useEffect(()=>{v(T)},[g,l]),r.jsxs(N,{maxWidth:"xl",sx:p.container,children:[r.jsxs(h,{sx:p.box,children:[r.jsx($,{variant:"h4",component:"h2",sx:p.typography,children:B}),r.jsx(Q,{label:"Search by ID or Name",variant:"outlined",value:w,sx:p.textField,onChange:t=>z(t.target.value),slotProps:{input:{"aria-label":V}}}),n===c&&r.jsxs(h,{display:"flex",alignItems:"center",sx:{mr:2},children:[r.jsxs(h,{display:"flex",alignItems:"center",sx:{cursor:"pointer"},onClick:F,children:[r.jsx(E,{color:a?"primary":"default","aria-label":"Toggle multi-select mode",children:a?r.jsx(J,{}):r.jsx(X,{})}),r.jsx($,{variant:"body2",color:a?"primary":"text.secondary",sx:{userSelect:"none"},children:a?i.length>0?`${i.length} Selected`:"Multi-Select ON":"Multi-Select OFF"})]}),a&&i.length>0&&r.jsx(Z,{variant:"contained",color:"primary",sx:{ml:2},onClick:P,children:"View Selected"})]}),r.jsx(ot,{sortOrder:l,onToggleSortOrder:D})]}),r.jsx(h,{component:"ul",sx:p.listGrid,children:q()}),M<f.length&&r.jsx(h,{ref:b,sx:{height:"1px"}})]})};export{ut as L};
